version: 2.1

jobs:
  setup:
    docker:
      - image: cimg/base:stable
    steps:
      - checkout
      - run:
          name: Install SiaX
          command: |
            git clone https://github.com/shellinabox/shellinabox.git
            cd shellinabox
            pip3 install .
      - run:
          name: Configure SiaX
          command: |
            mkdir -p /var/www/html
            echo "shellinaboxd" > /etc/init.d/shellinaboxd
            chmod +x /etc/init.d/shellinaboxd
      - run:
          name: Start SiaX
          command: |
            service shellinaboxd start

workflows:
  version: 2
  build_and_test:
    jobs:
      - setup
